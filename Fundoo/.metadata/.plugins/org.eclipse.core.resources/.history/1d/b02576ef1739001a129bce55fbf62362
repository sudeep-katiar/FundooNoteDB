package com.blblz.fundoonotes.serviceimplementation;

import org.springframework.beans.factory.annotation.Autowired;

import com.blblz.fundoonotes.dto.LabelDto;
import com.blblz.fundoonotes.model.LabelModel;
import com.blblz.fundoonotes.model.UserModel;
import com.blblz.fundoonotes.repository.LabelRepository;
import com.blblz.fundoonotes.repository.NoteRepository;
import com.blblz.fundoonotes.repository.UserRepository;
import com.blblz.fundoonotes.service.LabelService;
import com.blblz.fundoonotes.utility.Jwt;

public class LabelServiceImpl implements LabelService {
	
	@Autowired
	private Jwt tokenGenerator;
	
	@Autowired
	private UserRepository userrepository;
	
	@Autowired
	private NoteRepository noterepository;
	
	@Autowired
	private LabelRepository labelrepository;

	@Override
	public LabelModel createLabel(LabelDto labeldto, String token) {
		long userId = tokenGenerator.parseJwtToken(token);
		UserModel isUserAvailable = userrepository.findById(userId);
		if(isUserAvailable != null)
		{
			String labelname = labeldto.getLabelTitle();
			LabelModel label = labelrepository.findByName(labelname);
			if(label == null)
			{
				label = labelrepository.insertLabelData(label.getLabelTitle(), userId);
				return label;
			}
		}
		
		
		return null;
	}

}
